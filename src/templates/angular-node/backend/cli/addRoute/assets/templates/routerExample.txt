const express = require('express');
const router = express.Router();
const models = require('{{path_to_model}}');

/**
 * @typedef User
 * @property {integer} id.required - Identifiant - eg: 1
 * @property {string} login.required - Login - eg: Ivy234
 * @property {string} password.required - Password - eg: zbtLMEv8
 * @property {string} email.required - Email - eg: Ivy234@hotmail.com
 * @property {string} createdAt.required - Date de creation - eg: 2021-04-27T08:34:01.000Z
 * @property {string} updatedAt.required - Date de mise à jour - eg: 2021-04-27T08:34:01.000Z
 */

/**
 * @route GET /{{path}}
 * @summary Retourne la liste des utilisateurs
 * @group {{path}}
 * @returns {Array.<User>} 200 - Liste des utilisateurs
 * @returns {Error}  400 - Erreur dans la syntaxe de la requête
 * @returns {Error}  401 - Erreur lors de l'authentification
 */
router.get('/', async function (req, res, next) {
  try {
    const users = await models['users'].findAll();
    res.status(200).send({
      users
    });
  } catch (err) {
    res.status(400).send({
      error: err.parent ? err.parent.sqlMessage : err.errors
    });
  }
});

module.exports =  router;