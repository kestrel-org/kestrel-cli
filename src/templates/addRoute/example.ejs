const express = require('express');
const router = express.Router();
const models = require('<%= props.path_to_model %>');

/**
 * @typedef User
 * @property {integer} id.required - ID - eg: 1
 * @property {string} login.required - Login - eg: Ivy234
 * @property {string} password.required - Password - eg: zbtLMEv8
 * @property {string} email.required - Email - eg: Ivy234@hotmail.com
 * @property {string} createdAt.required - Creation date - eg: 2021-04-27T08:34:01.000Z
 * @property {string} updatedAt.required - Update date - eg: 2021-04-27T08:34:01.000Z
 */

/**
 * @route GET /<%= props.path %>
 * @summary Return the users list
 * @group <%= props.path %>
 * @returns {Array.<User>} 200 - Users list
 * @returns {Error}  400 - Error in query syntax
 * @returns {Error}  401 - Error during authentication
 */
router.get('/', async function (req, res, next) {
  try {
    const users = await models['users'].findAll();
    res.status(200).send({
      users
    });
  } catch (err) {
    res.status(400).send({
      error: err.parent ? err.parent.sqlMessage : err.errors
    });
  }
});

module.exports =  router;